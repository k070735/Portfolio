<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/sellPage.css" th:href="@{/src/css/sellPage.css}">
    <link rel="stylesheet" href="../css/topBar.css" th:href="@{/src/css/topBar.css}">
    <title>Revendor</title>

</head>

<body>
    <div class="wrap">
        <!--í—¤ë”(ê³ ì •ë°”)-->
        <div class="headerWrap" th:replace="fragments/common :: menu('sellPage')">

        </div>

        <div class="titleWrap">
            <div class="title">ğŸ ë¬¼ê±´ ë“±ë¡í•˜ê¸° ğŸ</div>
            <div class="subTitle">íŒë§¤í•˜ê³  ì‹¶ì€ ë¬¼ê±´ì— ëŒ€í•œ ì •ë³´ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”!</div>
            <div class="subTitle">ì†Œì¤‘í•œ ë¬¼ê±´ì´ ì¢‹ì€ ë¶„ë“¤ì—ê²Œ ê°ˆ ìˆ˜ ìˆê²Œ ìƒì„¸í•˜ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”ğŸ™</div>
        </div>


        <form action="a.jsp" th:action="@{/item/form}" th:object="${item}" method="POST">
            <!--querystring ì–˜ê°€ post(body)ë¡œ ê°€ë©´ urlì— ì•ˆëœ¸!! method ì„¤ì • ì•ˆí•˜ë©´ headerë¡œ ê°€ì„œ urlì— ë‹¤ ëœ¸...-->

            <!-- id ê°’ì„ hiddenì„ ì´ìš©í•´ ì„¤ì • -->
            <input type="hidden" th:field="*{id}">

            <div class="infoWrap">
                
                <div class="inputBlank">
                    <div class="labelText"><label for="picture">ì‚¬ì§„ ì²¨ë¶€</label></div>
                    <div class="picText"><label for="choosePic">ğŸ‘‰ì‚¬ì§„ ì²¨ë¶€í•˜ê¸° (Click)</label></div>
                    <input id="choosePic" type="file">

                    <p class="submitChange" onclick="onSubmitImage()">ğŸ‘‰URL ë³€í™˜ í•˜ê¸°</p>
                    <input class="submitUrl" id="imageLink" type="text" name="myphoto" th:field="*{url}"></input>
                    <!--ìš”ê±° í• ê±°ë©´ method="post" í•´ì£¼ê¸°. ì›ë˜ ë””í´íŠ¸ëŠ” getë°©ì‹ì´ì—ˆìŒ...-->
                </div>

                <!--ì œëª©-->
                <div class="inputBlank">
                    <div class="labelText"><label for="name">ê¸€ ì œëª©</label></div>
                    <input class="infoInput" id="title" type="text" name="title" placeholder="ê¸€ ì œëª© ì…ë ¥"
                        th:field="*{title}" required><br>
                </div>

                <!--ì¹´í…Œê³ ë¦¬ ì„ íƒ-->
                <!--ìˆ˜ì • : ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš” ì„ íƒ ì‹œ ë¹ ê¾¸...-->
                <!-- <div class="inputBlank">
                    <div class="labelText"><label for="category">ì¹´í…Œê³ ë¦¬</label></div>
                    <div class="categorySelect">
                        <select name="category" size="1">
                            <option value="" selected>ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                            <option value="ê³ ê°€ë¬¼í’ˆ">ê³ ê°€ ë¬¼í’ˆ</option>
                            <option value="NFT">NFT</option>
                        </select>
                    </div>
                </div> -->

                <!--ê°€ê²©-->
                <div class="inputBlank">
                    <div class="labelText"><label for="name">ê°€ê²©</label></div>
                    <input class="infoInput" id="price" type="number" name="price" placeholder="ê°€ê²© ì…ë ¥"
                        th:field="*{price}" required><br>
                </div>

                <!--ì§€ì—­-->
                <div class="inputBlank">
                    <div class="labelText"><label for="name">ì§€ì—­</label></div>
                    <input class="infoInput" id="name" type="text" name="location" placeholder="ì§€ì—­ ì…ë ¥"
                        th:field="*{location}" required><br>
                </div>

                <!--ì œì¶œ ë²„íŠ¼-->
                <button id="upload">ğŸ‘‰ë“±ë¡í•˜ê¸°ğŸ‘ˆ</button>
            </div>
        </form>
    </div>
    <!--í•˜ë‹¨ footer-->
    <footer th:replace="fragments/common :: footer">

    </footer>

    <script type="text/javascript">
        function onSubmitImage() {
            var form = new FormData();
            const file_name = document.getElementById("choosePic").files[0];
            console.log(file_name);
            form.append("image", file_name);

            var settings = {
                "url": "https://api.imgur.com/3/upload",
                "method": "POST",
                "timeout": 0,
                "headers": {
                    "Authorization": "Client-ID 3c0605d41a784c3",
                },
                "processData": false,
                "mimeType": "multipart/form-data",
                "contentType": false,
                "data": form
            };

            $.ajax(settings).done(function (response) {
                console.log("response: " + response);
                console.log(typeof (response));

                var jsonResponse = JSON.parse(response);
                console.log(typeof (jsonResponse));
                console.log(jsonResponse);

                console.log(jsonResponse.data);
                console.log(typeof (jsonResponse.data));

                console.log(jsonResponse.data.link);
                console.log(typeof (jsonResponse.data.link));

                $('#imageLink').val(jsonResponse.data.link);
            });

        }
        $("#upload").click(function () {
            var form = new FormData();
            var settings = {
                "url": "https://api.imgur.com/3/upload",
                "method": "POST",
                "timeout": 0,
                "headers": {
                    "Authorization": "Client-ID 3c0605d41a784c3"
                },
                "processData": false,
                "mimeType": "multipart/form-data",
                "contentType": false,
                "data": form
            };


            $.ajax(settings).done(function (response) {
                console.log("response: " + response);
                console.log(typeof (response));

                var jsonResponse = JSON.parse(response);
                console.log(typeof (jsonResponse));
                console.log(jsonResponse);

                console.log(jsonResponse.data);
                console.log(typeof (jsonResponse.data));

                console.log(jsonResponse.data.link);
                console.log(typeof (jsonResponse.data.link));

                $('#imageLink').val(jsonResponse.data.link);
            });

        });
    </script>
</body>

</html>